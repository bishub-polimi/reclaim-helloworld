(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{85765:(e,s,t)=>{Promise.resolve().then(t.bind(t,7284))},7284:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>P});var a=t(95155),r=t(4719),n=t(35965),l=t(12115);function i(e){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"w-screen h-screen absolute translate-y-[-50%] translate-x-[-50%] top-[50%] left-[50%] z-0 bg-opacity-20 bg-black flex justify-center items-center",onClick:()=>e.setIsOpen(!1),children:(0,a.jsx)("div",{className:"w-[80%] h-[50%] bg-background overflow-auto p-5 rounded-lg",children:e.proof?JSON.stringify(e.proof):""})})})}var c=t(21169),o=t(66006);function d(e){let s=async()=>{let s=e.providerID,t=await o.ReclaimProofRequest.init("0x8A88F2b97a97CF1Acd3Cc20d2CbBFF730ECE16d3","0x54aab461dda5579b5bf9f5ffd9cdf3585354b53531726dac649892a033d3d278",s),a=await t.getRequestUrl();console.log("Request URL:",a),e.setRequestUrl(a),await t.startSession({onSuccess:s=>{s&&("string"==typeof s?(console.log("SDK Message:",s),e.setProof(s)):"string"!=typeof s&&(console.log("Proof generation success",null==s?void 0:s.claimData.context),e.setProof(s)))},onError:e=>{console.error("Verification failed",e)}})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full",onClick:s,children:"Richiedi la Prova"})})}var x=t(6020);function u(e){return(0,a.jsx)("div",{className:"flex flex-col items-center w-full max-w-md",children:e.requestUrl?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("a",{href:e.requestUrl,target:"_blank",rel:"noopener noreferrer",className:"mb-4 mx-4 px-4 py-2 border-2 border-gray-400 text-gray-600 hover:border-gray-600  hover:text-gray-800 rounded-lg transition-colors duration-200 text-sm flex items-center justify-between w-auto",children:[(0,a.jsx)("span",{children:"Se sei da mobile, apri il link"}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2",children:[(0,a.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),(0,a.jsx)("polyline",{points:"15 3 21 3 21 9"}),(0,a.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),(0,a.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-3",children:(0,a.jsx)(x.Ay,{value:e.requestUrl,size:200})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center w-[200px] h-[200px] bg-gray-100 rounded-lg border-2 border-gray-200",children:(0,a.jsx)("h2",{className:"text-gray-500",children:"QR non ancora generato"})})})}var m=t(72095),f=t(71327),h=t(50860),b=t(93668),g=t(52604),p=t(27193),j=t(51680);let v=e=>{let{notifications:s,onClose:t}=e;if(!s.length)return null;let r=(e,s)=>{window.open("".concat("https://base-sepolia.blockscout.com","/").concat("coinbaseWallet"===s?"op":"tx","/").concat(e),"_blank")},n=e=>{if(!e.txHash)return e.message.slice(0,80)+"...";let s=e.message.split(e.txHash);return(0,a.jsxs)(a.Fragment,{children:[s[0],(0,a.jsxs)("button",{onClick:()=>r(e.txHash,e.walletType),className:"inline-flex items-center gap-1 underline hover:text-blue-600",children:["".concat(e.txHash.slice(0,6),"...").concat(e.txHash.slice(-4)),(0,a.jsx)(g.A,{className:"h-3 w-3"})]}),s[1]]})};return(0,a.jsx)("div",{className:"fixed top-20 right-4 left-4 md:left-auto md:w-96 z-50 space-y-4",children:s.map(e=>(0,a.jsx)("div",{className:"transition-all duration-300 ".concat(e.isVisible?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-2"),children:(0,a.jsx)("div",{className:"\n              rounded-lg border p-4 shadow-lg\n              ".concat("success"===e.type?"bg-[rgba(0,128,0,0.2)] border-green text-green":"bg-[rgba(220,38,38,0.2)] border-red text-red","\n              }\n            "),role:"alert",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:["success"===e.type?(0,a.jsx)(p.A,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):(0,a.jsx)(j.A,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-sm font-medium break-all",children:n(e)})]})})},e.id))})},N=()=>Math.random().toString(36).substr(2,9),y=e=>e.slice(0,66);function w(e){let s=(0,n.F)(),{notifications:t,addNotification:r,removeNotification:i}=function(){let[e,s]=(0,l.useState)([]),t=e=>{s(s=>s.filter(s=>s.id!==e))};return{notifications:e,addNotification:(e,a,r,n)=>{let l=N();s(s=>[...s,{id:l,message:e,type:a,isVisible:!0,txHash:r,walletType:n}]),setTimeout(()=>{t(l)},6e3)},removeNotification:t,extractMainHash:y}}(),c="0xEDdED412E852Ba5D54b133C6dbcae8C11a3C47a1",{data:d,writeContractAsync:x,isPending:u,isSuccess:g,error:p}=(0,m.x)({onError:e=>{console.error("[ClaimToken] Transaction Error:",e),r("Errore durante il mint: ".concat(e.message.split("\n")[0]),"error")}}),{isSuccess:j,data:w,error:k}=(0,f.g)({hash:d,enabled:!!d});(0,l.useEffect)(()=>{k&&(console.error("[ClaimToken] Transaction failed:",k),r(k.message.includes("execution reverted")?"Errore: Transazione fallita (execution reverted) - ".concat(k.message):"Errore durante il mint: ".concat(k.message),"error"))},[k]),(0,l.useEffect)(()=>{if(g&&d){var e;console.log("Transaction sent:",d),r("Transazione inviata! In attesa di conferma...","success",d,null===(e=s.connector)||void 0===e?void 0:e.type)}},[g,d]),(0,l.useEffect)(()=>{j&&w&&(console.log("Transaction confirmed:",w),setTimeout(()=>{var e;r("Token mintato con successo! TX: ","success",w.transactionHash,null===(e=s.connector)||void 0===e?void 0:e.type)},1500))},[j,w]);let{writeContracts:C,isPending:E}=(0,h.o)({mutation:{onSuccess:e=>{r("User Operation inviata! In attesa di conferma...","success",y(e))},onError:e=>{console.error("[ClaimToken] UserOperation Error:",e),r("Errore durante il mint: ".concat(e.message.split("\n")[0]),"error")}}}),P=async()=>{let t=[s.address,"0x0000000000000000000000000000000000000000000000000000000000000000",(0,o.transformForOnchain)(e.proof)];try{var a;(null===(a=s.connector)||void 0===a?void 0:a.type)==="coinbaseWallet"?C({contracts:[{address:c,abi:b.HV,functionName:"mint",args:t}],capabilities:{paymasterService:{url:"https://api.developer.coinbase.com/rpc/v1/base-sepolia/GkzqPNE48hUPaCJPOfAVC3YBBqMbk7d1"}}}):await x({address:c,abi:b.HV,functionName:"mint",args:t})}catch(e){console.error("[ClaimToken] Error:",e),r("Errore durante il mint: ".concat(e.message.split("\n")[0]),"error")}};return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(v,{notifications:t,onClose:i}),(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full",onClick:P,disabled:u||E,children:u||E?"Minting...":"Ottieni il Token"})]})}var k=t(89984);function C(){let[e,s]=(0,l.useState)(),[t,r]=(0,l.useState)(),[o,x]=(0,l.useState)(),[m,f]=(0,l.useState)(""),[h,g]=(0,l.useState)(),[p,j]=(0,l.useState)(!1),v=(0,n.F)(),N="0xEDdED412E852Ba5D54b133C6dbcae8C11a3C47a1",{data:y}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,0]}),{data:C}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,1]}),{data:E}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,2]}),P="c444924e-4136-4282-8d2b-6600b45812c3",F="f5d0ef53-97fd-4ec4-9c2f-d9e762eb1fc8",S="52795369-865f-43bc-a49b-bfd10624f90a",T=(e,t,n)=>t&&t>BigInt(0)?(0,a.jsxs)("div",{className:"text-center",children:["Ottenuto ",(0,a.jsx)(c.L7X,{className:"inline text-green"})]}):e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"text-blue-500",onClick:()=>{g(e),j(!0)},children:"Visualizza la Prova"}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(w,{proof:e,id:n})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center",children:["Prova mancante ",(0,a.jsx)(c.XfH,{className:"inline text-red"})]}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(d,{setProof:0===n?s:1===n?r:x,setRequestUrl:f,providerID:0===n?P:1===n?F:S})})]}),O=(e,t,n)=>t&&t>BigInt(0)?(0,a.jsxs)("div",{className:"text-center",children:["Ottenuto ",(0,a.jsx)(c.L7X,{className:"inline text-green"})]}):e?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{className:"text-blue-500",onClick:()=>{g(e),j(!0)},children:"Visualizza la Prova"}),(0,a.jsx)(w,{proof:e,id:n})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"text-center",children:["Prova mancante ",(0,a.jsx)(c.XfH,{className:"inline text-red"})]}),(0,a.jsx)(d,{setProof:0===n?s:1===n?r:x,setRequestUrl:f,providerID:0===n?P:1===n?F:S})]});return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center pt-10 md:pt-32 px-4 md:px-10 gap-y-2 md:gap-y-8",children:[(0,a.jsx)(u,{requestUrl:m}),(0,a.jsxs)("div",{className:"hidden md:flex flex-row items-center justify-center gap-x-12",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Punti Patente"}),O(e,y,0)]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Donazione"}),O(t,C,1)]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Carbon Footprint"}),O(o,E,2)]})]}),(0,a.jsx)("div",{className:"md:hidden w-full",children:(0,a.jsx)("table",{className:"w-full",children:(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Punti Patente"}),T(e,y,0)]})})}),(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Donazione"}),T(t,C,1)]})})}),(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Carbon Footprint"}),T(o,E,2)]})})})]})})}),p&&(0,a.jsx)(i,{setIsOpen:j,proof:h})]})}function E(){let e=(0,n.F)();return(0,a.jsx)(a.Fragment,{children:"connected"==e.status?(0,a.jsx)(C,{}):(0,a.jsx)("div",{className:"flex justify-center items-center h-full w-full",children:"Per favore connetti il tuo wallet"})})}function P(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{backButton:!1,gameButton:!0}),(0,a.jsx)(E,{})]})}},4719:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(95155),r=t(64276),n=t(48173),l=t.n(n);function i(e){return(0,a.jsxs)("div",{className:"w-full p-4 flex justify-between",children:[(0,a.jsx)(l(),{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full self-center ".concat(e.backButton?"":"hidden"),href:"/",children:"Indietro"}),(0,a.jsx)(l(),{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full self-center ".concat(e.gameButton?"":"hidden"),href:"/game",children:"Gioco"}),(0,a.jsx)(r.pK,{})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8451,3380,8915,8173,2214,3668,8441,1517,7358],()=>s(85765)),_N_E=e.O()}]);