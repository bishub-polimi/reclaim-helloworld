(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{85765:(e,s,t)=>{Promise.resolve().then(t.bind(t,7284))},7284:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>E});var a=t(95155),n=t(4719),r=t(35965),l=t(12115);function i(e){return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"w-screen h-screen absolute translate-y-[-50%] translate-x-[-50%] top-[50%] left-[50%] z-0 bg-opacity-20 bg-black flex justify-center items-center",onClick:()=>e.setIsOpen(!1),children:(0,a.jsx)("div",{className:"w-[80%] h-[50%] bg-background overflow-auto p-5 rounded-lg",children:e.proof?JSON.stringify(e.proof):""})})})}var c=t(21169),o=t(66006);function d(e){let s=async()=>{let s=e.providerID,t=await o.ReclaimProofRequest.init("0x8A88F2b97a97CF1Acd3Cc20d2CbBFF730ECE16d3","0x54aab461dda5579b5bf9f5ffd9cdf3585354b53531726dac649892a033d3d278",s),a=await t.getRequestUrl();console.log("Request URL:",a),e.setRequestUrl(a),await t.startSession({onSuccess:s=>{s&&("string"==typeof s?(console.log("SDK Message:",s),e.setProof(s)):"string"!=typeof s&&(console.log("Proof generation success",null==s?void 0:s.claimData.context),e.setProof(s)))},onError:e=>{console.error("Verification failed",e)}})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full",onClick:s,children:"Richiedi la Prova"})})}var x=t(6020);function u(e){return(0,a.jsx)("div",{className:"flex flex-col items-center w-full max-w-md",children:e.requestUrl?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("a",{href:e.requestUrl,target:"_blank",rel:"noopener noreferrer",className:"mb-4 mx-4 px-4 py-2 border-2 border-gray-400 text-gray-600 hover:border-gray-600  hover:text-gray-800 rounded-lg transition-colors duration-200 text-sm flex items-center justify-between w-auto",children:[(0,a.jsx)("span",{children:"Se sei da mobile, apri il link"}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-2",children:[(0,a.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),(0,a.jsx)("polyline",{points:"15 3 21 3 21 9"}),(0,a.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]})]}),(0,a.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-3",children:(0,a.jsx)(x.Ay,{value:e.requestUrl,size:200})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center w-[200px] h-[200px] bg-gray-100 rounded-lg border-2 border-gray-200",children:(0,a.jsx)("h2",{className:"text-gray-500",children:"QR non ancora generato"})})})}var m=t(72095),f=t(71327),h=t(50860),b=t(93668),g=t(52604),j=t(27193),p=t(51680);let v=()=>Math.random().toString(36).substr(2,9),N=e=>e.slice(0,66),y=e=>{let{notifications:s,onClose:t}=e;if(!s.length)return null;let n=e=>{let s=e.length>66?"op":"tx",t=e.length>66?N(e):e;window.open("".concat("https://base-sepolia.blockscout.com","/").concat(s,"/").concat(t),"_blank")},r=e=>{if(!e.txHash)return e.message.slice(0,120);let s=e.message.split(e.txHash);return(0,a.jsxs)(a.Fragment,{children:[s[0],(0,a.jsxs)("button",{onClick:()=>n(e.txHash),className:"inline-flex items-center gap-1 underline hover:text-blue-600",children:["".concat(e.txHash.slice(0,6),"...").concat(e.txHash.slice(-4)),(0,a.jsx)(g.A,{className:"h-3 w-3"})]}),s[1]]})};return(0,a.jsx)("div",{className:"fixed top-20 right-4 left-4 md:left-auto md:w-96 z-50 space-y-4",children:s.map(e=>(0,a.jsx)("div",{className:"transition-all duration-300 ".concat(e.isVisible?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-2"),children:(0,a.jsx)("div",{className:"\n              rounded-lg border p-4 shadow-lg\n              ".concat("success"===e.type?"bg-[rgba(160,246,160,0.95)] border-green text-green":"bg-[rgba(243,173,173,0.95)] border-red text-red","\n              }\n            "),role:"alert",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:["success"===e.type?(0,a.jsx)(j.A,{className:"h-5 w-5 text-green-600 flex-shrink-0 mt-0.5"}):(0,a.jsx)(p.A,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-base font-bold break-all",children:r(e)})]})})},e.id))})};function w(e){let s=(0,r.F)(),{notifications:t,addNotification:n,removeNotification:i}=function(){let[e,s]=(0,l.useState)([]),t=e=>{s(s=>s.filter(s=>s.id!==e))};return{notifications:e,addNotification:(e,a,n)=>{let r=v();s(s=>[...s,{id:r,message:e,type:a,isVisible:!0,txHash:n}]),setTimeout(()=>{t(r)},8e3)},removeNotification:t,extractMainHash:N}}(),c="0xEDdED412E852Ba5D54b133C6dbcae8C11a3C47a1",d=e=>{let s=e.message.match(/execution reverted: (.*?)(?:\.|\n|$)/);return(null==s?void 0:s[1])?s[1]:e.message},{data:x,writeContractAsync:u,isPending:g,isSuccess:j,error:p}=(0,m.x)(),{isSuccess:w,data:k,error:C,isError:P}=(0,f.g)({hash:x,enabled:!!x});(0,l.useEffect)(()=>{P&&C&&x&&(console.log("Transaction reverted:",C),n("".concat(d(C)),"error"))},[P,C,x]);let{writeContractsAsync:E,isPending:F}=(0,h.o)({mutation:{onError:e=>{console.error("[ClaimToken] UserOperation Error:",e),n("Errore durante l'invio: ".concat(e.message.split("\n")[0]),"error")}}}),S=async()=>{let t=[s.address,"0x0000000000000000000000000000000000000000000000000000000000000000",(0,o.transformForOnchain)(e.proof)];try{var a;if((null===(a=s.connector)||void 0===a?void 0:a.type)==="coinbaseWallet"){n("Invio User Operation in corso...","success");let e=await E({contracts:[{address:c,abi:b.HV,functionName:"mint",args:t}],capabilities:{paymasterService:{url:"https://api.developer.coinbase.com/rpc/v1/base-sepolia/GkzqPNE48hUPaCJPOfAVC3YBBqMbk7d1"}}});setTimeout(()=>{n("User Operation inviata: ","success",e),console.log("UserOperation result:",e)},1500),setTimeout(()=>{n("In attesa del minting...","success")},1500)}else{let e=await u({address:c,abi:b.HV,functionName:"mint",args:t});setTimeout(()=>{n("Transazione inviata: ","success",e),n("In attesa del minting...","success"),console.log("Transaction result:",e)},1500),setTimeout(()=>{n("In attesa del minting...","success")},1500)}}catch(e){console.error("[ClaimToken] Error:",e),n("Errore durante il mint: ".concat(e.message.split("\n")[0]),"error")}};return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(y,{notifications:t,onClose:i}),(0,a.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full",onClick:S,disabled:g||F,children:g||F?"Minting...":"Ottieni il Token"})]})}var k=t(89984);function C(){let[e,s]=(0,l.useState)(),[t,n]=(0,l.useState)(),[o,x]=(0,l.useState)(),[m,f]=(0,l.useState)(""),[h,g]=(0,l.useState)(),[j,p]=(0,l.useState)(!1),v=(0,r.F)(),N="0xEDdED412E852Ba5D54b133C6dbcae8C11a3C47a1",{data:y}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,0]}),{data:C}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,1]}),{data:P}=(0,k.Q)({address:N,abi:b.HV,functionName:"balanceOf",args:[v.address,2]}),E="c444924e-4136-4282-8d2b-6600b45812c3",F="f5d0ef53-97fd-4ec4-9c2f-d9e762eb1fc8",S="52795369-865f-43bc-a49b-bfd10624f90a",O=(e,t,r)=>t&&t>BigInt(0)?(0,a.jsxs)("div",{className:"text-center animate-shine-once",children:["Token ottenuto ",(0,a.jsx)(c.L7X,{className:"inline text-green"})]}):e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"text-blue-500",onClick:()=>{g(e),p(!0)},children:"Visualizza la Prova"}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(w,{proof:e,id:r})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center",children:["Prova mancante ",(0,a.jsx)(c.XfH,{className:"inline text-red"})]}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)(d,{setProof:0===r?s:1===r?n:x,setRequestUrl:f,providerID:0===r?E:1===r?F:S})})]}),U=(e,t,r)=>t&&t>BigInt(0)?(0,a.jsxs)("div",{className:"text-center animate-shine-once",children:["Token ottenuto ",(0,a.jsx)(c.L7X,{className:"inline text-green"})]}):e?(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{className:"text-blue-500",onClick:()=>{g(e),p(!0)},children:"Visualizza la Prova"}),(0,a.jsx)(w,{proof:e,id:r})]}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"text-center",children:["Prova mancante ",(0,a.jsx)(c.XfH,{className:"inline text-red"})]}),(0,a.jsx)(d,{setProof:0===r?s:1===r?n:x,setRequestUrl:f,providerID:0===r?E:1===r?F:S})]});return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center pt-10 md:pt-32 px-4 md:px-10 gap-y-2 md:gap-y-8",children:[(0,a.jsx)(u,{requestUrl:m}),(0,a.jsxs)("div",{className:"hidden md:flex flex-row items-center justify-center gap-x-12",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Punti Patente"}),U(e,y,0)]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Donazione"}),U(t,C,1)]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-4 h-full",children:[(0,a.jsx)("h2",{className:"text-center font-bold",children:"Carbon Footprint"}),U(o,P,2)]})]}),(0,a.jsx)("div",{className:"md:hidden w-full",children:(0,a.jsx)("table",{className:"w-full",children:(0,a.jsxs)("tbody",{children:[(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Punti Patente"}),O(e,y,0)]})})}),(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Donazione"}),O(t,C,1)]})})}),(0,a.jsx)("tr",{className:"border-b",children:(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("h2",{className:"font-bold",children:"Carbon Footprint"}),O(o,P,2)]})})})]})})}),j&&(0,a.jsx)(i,{setIsOpen:p,proof:h})]})}function P(){let e=(0,r.F)();return(0,a.jsx)(a.Fragment,{children:"connected"==e.status?(0,a.jsx)(C,{}):(0,a.jsx)("div",{className:"flex justify-center items-center h-full w-full",children:"Per favore connetti il tuo wallet"})})}function E(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.A,{backButton:!1,gameButton:!0}),(0,a.jsx)(P,{})]})}},4719:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(95155),n=t(64276),r=t(48173),l=t.n(r);function i(e){return(0,a.jsxs)("div",{className:"w-full p-4 flex justify-between",children:[(0,a.jsx)(l(),{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full self-center ".concat(e.backButton?"":"hidden"),href:"/",children:"Indietro"}),(0,a.jsx)(l(),{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full self-center ".concat(e.gameButton?"":"hidden"),href:"/game",children:"Gioco"}),(0,a.jsx)(n.pK,{})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8451,3380,5714,8173,2214,3668,8441,1517,7358],()=>s(85765)),_N_E=e.O()}]);